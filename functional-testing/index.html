<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Functional Testing - consumerfinance.gov</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="../css/overrides.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Functional Testing";
    var mkdocs_page_input_path = "functional-testing.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> consumerfinance.gov</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Introduction</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../installation/">Installation</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Running this Project</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../running-virtualenv/">Running in a Virtual Environment</a>
                </li>
                <li class="">
                    
    <a class="" href="../running-docker/">Running in Docker</a>
                </li>
                <li class="">
                    
    <a class="" href="../debugging-monitoring/">Debugging and Monitoring</a>
                </li>
                <li class="">
                    
    <a class="" href="../deployment/">Artifacts and Deployment</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Pages and Components</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../atomic-structure/">Atomic Structure and Design</a>
                </li>
                <li class="">
                    
    <a class="" href="../editing-components/">Creating and Editing Components</a>
                </li>
                <li class="">
                    
    <a class="" href="../debugging-templates/">Debugging Templates</a>
                </li>
                <li class="">
                    
    <a class="" href="../migrations/">Django and Wagtail Migrations</a>
                </li>
                <li class="">
                    
    <a class="" href="../forms-in-wagtail/">Forms in Wagtail Page Context</a>
                </li>
                <li class="">
                    
    <a class="" href="../wagtail-pages/">Wagtail Pages</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Supporting Features</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../caching/">Caching</a>
                </li>
                <li class="">
                    
    <a class="" href="../feature-flags/">Feature Flags</a>
                </li>
                <li class="">
                    
    <a class="" href="../filterable-lists/">Filterable Lists</a>
                </li>
                <li class="">
                    
    <a class="" href="../search/">Search</a>
                </li>
                <li class="">
                    
    <a class="" href="../split-testing.md">Split Testing</a>
                </li>
                <li class="">
                    
    <a class="" href="../translation/">Translation</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Testing</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../javascript-unit-tests/">JavaScript Unit Testing</a>
                </li>
                <li class="">
                    
    <a class="" href="../python-unit-tests/">Python Unit Testing</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Functional Testing</a>
    <ul class="subnav">
            
    
        <ul>
        
            <li><a class="toctree-l4" href="#installing-cypress">Installing Cypress</a></li>
        
            <li><a class="toctree-l4" href="#running-cypress">Running Cypress</a></li>
        
            <li><a class="toctree-l4" href="#writing-cypress-tests">Writing Cypress Tests</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../profiling-django/">Profiling Django</a>
                </li>
                <li class="">
                    
    <a class="" href="../other-front-end-testing/">Other Front-end Testing</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Contributing</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../branching-merging/">Branching and Merging</a>
                </li>
                <li class="">
                    
    <a class="" href="../contributing-docs/">Contributing to the Docs</a>
                </li>
                <li class="">
                    
    <a class="" href="../related-projects/">Related Projects</a>
                </li>
                <li class="">
                    
    <a class="" href="../development-tips/">Development Tips</a>
                </li>
                <li class="">
                    
    <a class="" href="../github-actions/">How We Use GitHub Actions</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">APIs and Data</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../ask-cfpb/">Ask CFPB</a>
                </li>
                <li class="">
                    
    <a class="" href="../consumer-complaint-database/">Consumer Complaints</a>
                </li>
                <li class="">
                    
    <a class="" href="../housing-counselor-tool/">Find a Housing Counselor Tool</a>
                </li>
                <li class="">
                    
    <a class="" href="../website-feedback/">Website Feedback</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">consumerfinance.gov</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Testing &raquo;</li>
        
      
    
    <li>Functional Testing</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/cfpb/consumerfinance.gov/edit/master/docs/functional-testing.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="functional-testing-with-cypress">Functional Testing with Cypress<a class="headerlink" href="#functional-testing-with-cypress" title="Permanent link">¶</a></h1>
<p>In order to ensure that as we upgrade our wagtail/django dependencies our backend python code is still functional from a frontend perspective we are integrating a new browser testing tool <a href="https://www.cypress.io">Cypress</a>. The goal is to implement and maintain a testing suite that enables confidence in dependency upgrades.</p>
<h2 id="installing-cypress">Installing Cypress<a class="headerlink" href="#installing-cypress" title="Permanent link">¶</a></h2>
<p>We have included Cypress as a dependency of this project, and so the only steps that need to be taken are doing a fresh <code>yarn</code> if you haven't already.</p>
<h2 id="running-cypress">Running Cypress<a class="headerlink" href="#running-cypress" title="Permanent link">¶</a></h2>
<p>We support both a headless docker container to execute our cypress tests as well as the already installed desktop application that comes packaged with cypress. The test files are located in the <code>test/cypress/integration/</code> directory.</p>
<ul>
<li>To run a single docker container use <code>docker-compose -f docker-compose.e2e.yml run admin-tests</code></li>
<li>To run all docker containers execute <code>docker-compose -f docker-compose.e2e.yml up</code></li>
<li>
<p>If you have not previously set up a local Docker network, you will need to stop any running consumerfinance.gov Docker containers, run <code>docker network create cfgov</code>, start the containers again, and then run the above command.</p>
</li>
<li>
<p>To run the desktop cypress aplication execute <code>yarn run cypress open</code> and select your test file to execute.</p>
</li>
<li>
<p>To run the tests from the commandline you can also invoke them via <code>yarn run cypress run</code>. You can read more about different command line arguments in the <a href="https://docs.cypress.io/guides/guides/command-line.html#Options">Command-Line Documentation</a> provided by Cypress.</p>
</li>
<li>
<p>To run the tests against a server other than <code>http://localhost:8000</code>, you can pass in an override for the <code>baseUrl</code> config value; for example:<code>yarn run cypress open --config baseUrl=http://staging_url</code>.</p>
</li>
</ul>
<h2 id="writing-cypress-tests">Writing Cypress Tests<a class="headerlink" href="#writing-cypress-tests" title="Permanent link">¶</a></h2>
<p>When developing new tests for Cypress it is important to consider what the test is trying to accomplish. We want to ensure that we are not polluting our cypress tests with things that can be tested at another level, we are seeking to only test the integration aspect of our UI hosted via Wagtail/Django and custom python code within our backend.</p>
<p>When adding a test it is often helpful to separate the arrange/act code from the actual assertions in order to improve the readability of our testing code. To do this we have adopted the page model of testing, where we define a page within the application and the methods of interacting with the page separate from the test file itself where we define the assertions. We call these files "helpers" and label them as such (example: <code>megamenu-helpers.js</code>), and we include them alongside the test files themselves in the <code>test/cypress/integration/</code> folder. (They are ignored when running tests thanks to the configuration of <code>cypress.json</code>.)</p>
<p>For example consider the ConsumerTools Page "helper":</p>
<pre class="highlight"><code class="language-javascript">export default class ConsumerTools {

    constructor() {}

    open() {
        cy.visit('/consumer-tools/');
    }

    signUp(email) {
        cy.get('.o-form__email-signup').within(() =&gt; {
            cy.get('input:first').type(email);
            cy.get('button:first').click();
        });
    }
    successNotification() {
        return cy.get('.m-notification_message');
    }
}</code></pre>

<p>Notice how this class defines functions to retrieve and modify elements on the page but in a more human readable manner. This allows our test file for consumer tools to look like:</p>
<pre class="highlight"><code class="language-javascript">import ConsumerTools from './consumer-tools-helpers';

let page = new ConsumerTools();

describe('Consumer Tools', () =&gt; {
    it('Should have an email sign up', () =&gt; {
        // Arrange
        page.open();
        // Act
        page.signUp('testing@cfpb.gov');
        // Assert
        page.successNotification().should('exist');
        page.successNotification().contains('Your submission was successfully received.')
    });
});</code></pre>

<p>Overall it lets our tests show what is intended to be happening on a page without showing the more technical side of how we reference and interact with elements.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../profiling-django/" class="btn btn-neutral float-right" title="Profiling Django">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../python-unit-tests/" class="btn btn-neutral" title="Python Unit Testing"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/cfpb/consumerfinance.gov/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../python-unit-tests/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../profiling-django/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
