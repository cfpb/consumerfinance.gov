{% extends "layout-side-nav.html" %}
{% import "_section_newsroom.html" as section with context %}
{% import "post-macros.html" as post_macros with context %}

{# Variables #}

{% set active_filters =
   selected_filters_for_field('category') +
   selected_filters_for_field('tags') +
   selected_filters_for_field('author')
%}
{% set active_date_filters =
   selected_filters_for_field('range_date_gte') + 
   selected_filters_for_field('range_date_lte')
%}
{% set active_filters_total = active_filters|length + active_date_filters|length %}
{% set view = get_document('views', 'newsroom') %}

{# Block overrides #}

{% block demo_title -%}
    Newsroom listing
{%- endblock %}

{% block title -%}
    Newsroom
{%- endblock %}

{% block desc -%}
    Press releases, speeches, op-eds, testimony, and blog posts produced by our Office of Communications
{%- endblock %}

{% block content_main %}

    {% import "post-filters.html" as post_filters %}
    {{ post_filters.render(section.newsrooms, active_filters, active_filters_total, active_date_filters, section.query, post_macros, selected_filters_for_field, current_date, section.path) }}

    {% import "watchroom.html" as watchroom %}
    {{ watchroom.render(queries.watchroom.search_with_url_arguments(size=1)) }}

    {% import "posts-paginated.html" as posts_paginated %}
    {{ posts_paginated.render(section.newsrooms, post_macros) }}

    <aside>
        <section class="content_block">
            <h1 class="header-slug">
                <span class="header-slug_inner">
                    Stay informed
                </span>
            </h1>
            <div class="content-l">
                <div class="content_block__sub content-l_col content-l_col-1-2">
                    <p class="short-desc">
                        Subscribe to our email newsletter. We will update you on new newsroom updates.
                    </p>
                    {% import "email-subscribe-form.html" as email_subscribe_form %}
                    {{ email_subscribe_form.render(section.query) }}
                </div>
                <div class="content_block__sub content-l_col content-l_col-1-2">
                    {% import "rss.html" as rss %}
                    {{ rss.render(section.rss_path) }}
                </div>
            </div>
        </section>
        <div class="content_block content_block__flush-bottom content_block__flush-sides content_block__bg">
            <div class="content-l">
                <section class="content_block content_block__flush-top content-l_col content-l_col-1-2">
                    {% import "related-links.html" as related_links %}
                    {{ related_links.render(view.related_links) }}
                </section>
                <section class="content_block content-l_col content-l_col-1-2">
                    {% include "upcoming-events.html" %}
                </section>
            </div>
        </div>
    </aside>
{% endblock %}
