{% extends 'layout-2-1-bleedbar.html' %}
{% if not page %}
    {% do global_dict.update({
            'page':  {
                'seo_title':     'Learn Page - This is a prototype page for testing page layouts.',
                'related_posts': global_dict.related_posts_function
            },
            'related_posts_settings': {
                'value': {
                    'limit':            3,
                    'show_heading':     true,
                    'related_posts':    false,
                    'related_newsroom': false,
                    'related_events':   false,
                }
            },
            'prototype': true
        })
    %}
    {% set page = page or global_dict.page %}
    {% set prototype = global_dict.prototype or false %}
    {% set breadcrumb_items = [('#', '#', 'Sample Breadcrumb')] %}
{% endif %}

{% import 'atoms/large-checkbox.html' as large_checkbox %}
{% import 'atoms/large-radio.html' as large_radio %}

{% import 'molecules/related-posts.html' as related_posts with context %}
{% import 'organisms/post-preview.html' as post_preview %}
{% import 'organisms/sidebar-contact-info.html' as sidebar_contact_info %}
{% import 'molecules/related-metadata.html' as related_metadata with context %}

{% if not breadcrumb_items %}
    {% set parent = page.parent() %}
    {% set breadcrumb_items = [(parent.url, parent.url, parent.title)] %}
{% endif %}

{% if not page %}
    {% set prototype = true %}
{% endif %}

{% block title -%}
    {{ page.seo_title }}
{%- endblock %}

{% block content_main_modifiers -%}
    {{ super() }} content__flush-bottom
{%- endblock %}

{# TODO: Remove lipsumText when and if it is no longer needed. #}
{% set lipsumText = lipsum(1, false, 10, 25) | safe %}

{% block content_main %}
    {% for block in page.header -%}
        <div class="block
                    block__flush-top">
            {{ render_stream_child(block) }}
        </div>
    {%- endfor %}

    {% for block in page.content -%}
        <div class="block">
            {{ render_stream_child(block) }}
        </div>
    {%- endfor %}

    {% if prototype %}
        {# Area 1 #}
        <div class="block
                    block__flush-top">
            {% include 'molecules/text-introduction.html' %}
        </div>
        {# TODO: This should use either the text intro or the item intro, not both #}
        <div class="block
                    block__flush-top">
            {% include 'organisms/item-introduction.html' %}
        </div>

        {# Area 2 #}
        <div class="block">
            {# NOTE: includes Bulleted List and Inset molecules. #}
            {% include 'organisms/full-width-text.html' %}
        </div>

        <form class="js-validate-filters">
            <h2>A form</h2>
            <p class="o-form-description">
                All questions required (unless otherwise noted)
            </p>
            <h3>Checkboxes and Radio Buttons</h3>
            <div class="o-form-section">
                {{ large_checkbox.render( {
                    'legend':   'Choose toppings',
                    'fields':   ['cheese', 'pepperoni', 'anchovies', 'mushrooms'],
                    'size':     '1-2'
                }, {
                    'required': 'true'
                }) }}
                {{ large_radio.render( {
                    'legend':   'Extra Cheese',
                    'fields':   ['Yes', 'No'],
                    'size':     '1-2'
                }, {
                    'required': 'true'
                }) }}
            </div>

            <h3>Text fields</h3>
            <div class="o-form-section">
                {% do global_dict.update({
                    'input': {
                        'label':        'First name',
                        'type':         'text',
                        'size':         '1-2',
                        'required':     true,
                        'disabled':     false
                    }
                }) %}
                {% set value = global_dict.input %}
                {% set prototype = true %}
                {% include 'atoms/input.html' with context %}

                {% do global_dict.update({
                    'input': {
                        'label':        'Last name',
                        'type':         'text',
                        'size':         '1-2',
                        'required':     true,
                        'disabled':     false
                    }
                }) %}
                {% set value = global_dict.input %}
                {% set prototype = true %}
                {% include 'atoms/input.html' with context %}

                {% do global_dict.update({
                    'input': {
                        'label':        'Address 1',
                        'type':         'text',
                        'size':         '1',
                        'required':     false,
                        'disabled':     false
                    }
                }) %}
                {% set value = global_dict.input %}
                {% set prototype = true %}
                {% include 'atoms/input.html' with context %}

                {% do global_dict.update({
                    'input': {
                        'label':        'City',
                        'type':         'text',
                        'size':         '1-2',
                        'required':     true,
                        'disabled':     false
                    }
                }) %}
                {% set value = global_dict.input %}
                {% set prototype = true %}
                {% include 'atoms/input.html' with context %}

                {% include 'atoms/state-selector.html' %}

                {% do global_dict.update({
                    'input': {
                        'label':        'Zip code',
                        'type':         'text',
                        'size':         '1-4',
                        'required':     true,
                        'disabled':     false
                    }
                }) %}
                {% set value = global_dict.input %}
                {% set prototype = true %}
                {% include 'atoms/input.html' with context %}

                {% do global_dict.update({
                    'textarea': {
                        'label':        lipsumText,
                        'helperText':   lipsumText,
                        'required':     true,
                        'disabled':     false
                    }
                }) %}
                {% set value = global_dict.textarea %}
                {% set prototype = true %}
                {% include 'atoms/textarea.html' with context %}
            </div>
            <div class="o-form-section">
                {% include 'atoms/select.html' with context %}
            </div>
            {% do global_dict.update({
                'submit_button': {
                    'button_text':  'Generate PDF'
                }
            }) %}
            {% set value = global_dict.submit_button %}
            {% include 'atoms/submit-button.html' with context %}
        </form>
        <div class="block">
            {% do global_dict.update(
                {
                    'expandable': {
                        'label': 'Midtone Expandable',
                        'paragraph': lipsum(1, false, 10, 225),
                        'is_bordered': true,
                        'is_midtone': true,
                        'is_expanded': false
                    }

                })
            %}
            {% set value = global_dict.expandable %}
            {% include 'molecules/expandable.html' with context %}
            {% set value = None if prototype %}
        </div>
        <div class="block">
            {% include 'organisms/well.html' %}
        </div>
        <div class="block">
            {% include 'organisms/image-text-25-75-group.html' %}
        </div>

    {% endif %}
{% endblock %}

{% block content_sidebar_modifiers -%}
    o-sidebar-content
{%- endblock %}

{% block content_sidebar scoped -%}
    {% if prototype %}
        {{ related_posts.render(global_dict.related_posts_settings) }}
        {{ sidebar_contact_info.render({
            'heading': 'Header for text below',
            'body':    lipsumText
        }, {
            'emails':  ['test@example.com'],
            'phones':  [{'number': '1234567899',
                         'vanity': '123456AAAA',
                         'tty':    '1234567899'}],
            'faxes':   [{'number': '1234567899'}],
            'address': {
                'title':    'Consumer Financial Protection Bureau',
                'street':   '1700 G Street, NW',
                'city':     'Washington',
                'state':    'DC',
                'zip_code': '20552-0003'
        }
        }) }}
    {% else %}
        {% for block in page.sidefoot %}
        <div class="block block__flush-top">
            {% if 'related_posts' in block.block_type %}
                {{ related_posts.render(block) }}
            {% else %}
                {% if 'heading' in block.block_type %}
                    <h3 class="o-sidebar-breakout_heading">
                        {{ render_stream_child(block) }}
                    </h3>
                {% elif 'slug' in block.block_type %}
                    <h2 class="header-slug">
                        <span class="header-slug_inner">
                            {{ render_stream_child(block) }}
                        </span>
                    </h2>
                {% elif 'paragraph' in block.block_type %}
                    {{ render_stream_child(block) }}
                {% elif 'related_metadata' in block.block_type %}
                    {{ related_metadata.render(block.value) }}
                {% else %}
                    {{ render_stream_child(block) }}
                {% endif %}
            {% endif %}
        </div>
        {% endfor %}
    {% endif %}
{%- endblock %}
