{% extends 'layout-2-1-bleedbar.html' %}

{% import 'form_block.html' as form_block with context %}
{% import 'organisms/item-introduction.html' as item_introduction with context %}
{% import 'templates/render_block.html' as render_block with context %}
{% import 'templates/streamfield-sidefoot.html' as streamfield_sidefoot with context %}

{% block content_main_modifiers -%}
    {{ super() }} content__flush-bottom
{%- endblock %}

{% block content_main %}
    {% for block in page.header -%}
        {% if block.block_type == 'item_introduction' %}
            {{ item_introduction.render(block.value) }}
        {% else %}
            {{ render_block.render(block, loop.index) }}
        {% endif %}
    {%- endfor %}
    {% set is_faq = {"value": false} %}
    {% for block in page.content -%}
        {% if block.block_type == 'feedback' %}
            {{- form_block.render(block, 'content', loop.index0) -}}
        {% elif block.block_type == 'contact_expandable_group' %}
            <div class="block">
                {% include_block block %}
            </div>
        {% else %}
            {% if is_faq.value == false and (block.block_type == 'faq_group' or ( block.block_type == 'expandable_group' and block.value.is_faq == true ))%}
                {% do is_faq.update({"value": true}) %}
                <div itemscope="" itemtype="http://schema.org/FAQPage">
            {% endif %}
            {{ render_block.render(block, loop.index) }}
        {% endif %}
        {% if loop.last and is_faq.value == true %}
            </div>
        {% endif %}
    {%- endfor %}
{% endblock %}

{% block content_sidebar_modifiers -%}
    o-sidebar-content
{%- endblock %}

{% block content_sidebar scoped -%}
    {{ streamfield_sidefoot.render(page.sidefoot) }}
{%- endblock %}
