{% extends 'content-base.html' %}
{% from 'organisms/expandable.html' import expandable with context %}

{% block title -%}
    Survey Results | Consumer Financial Protection Bureau
{%- endblock %}

{% block css -%}
    {{ super() }}

    <link rel="stylesheet" href="{{ static('apps/teachers-digital-platform/css/main.css') }}">
{%- endblock css %}

{% block pre_content scoped -%}
{%- endblock %}

{% block body_content scoped %}
    <div class="content_wrapper tdp-survey-results">
        {% set overall = content.find_overall_progress(score) %}
        {% set bbs = content.building_blocks() %}

        {% if not is_student %}
            <article class="m-card">
                <h2 class="m-card_heading">
                    <span>Shared results <span hidden class="show-initials">for <strong></strong></span></span>
                </h2>
            </article>
        {% endif %}

        <h1>Your money journey results</h1>
        <h2>Congratulations, {{ overall.heading_html|safe }}</h2>
        <p>{{ overall.msg_html|safe }}</p>

        <p>[CAR in position {{ overall.position_idx }}]</p>

        <p>[SHARES]</p>
        {% if is_student %}
            <form class="share-url-form">
                <div class="share-customize">
                    <input class="a-text-input"
                           type="text"
                           name="initials"
                           placeholder="Enter your initials"
                           required minlength="2" maxlength="4" autocomplete="off">
                    <button class="a-btn">Create URL</button>
                </div>
                <div class="share-output" hidden>
                    <input readonly type="text" onclick="this.select()" value=""
                           class="shared-url a-text-input a-text-input__full" data-rparam="{{ r_param }}">
                </div>
            </form>
        {% endif %}

        <h2>Exploring your results</h2>
        <p>Your overall result is based...</p>

        <div class="o-expandable-group">
            {% set bb = 0 %}
            {% set progress = content.find_bb_progress(bb, subtotals[bb]) %}
            <div class="o-expandable o-expandable__padded">
                <button class="o-expandable_header o-expandable_target"
                        title="Expand content">
                    <h3 class="h4 o-expandable_header-left o-expandable_label">
                        [ICON] {{ bbs[bb].title }}
                    </h3>
                    <span class="o-expandable_header-right o-expandable_link">
                <span class="o-expandable_cue o-expandable_cue-open">
                    <span class="u-visually-hidden-on-mobile">Show</span>
                    {% include 'icons/plus-round.svg' %}
                </span>
                <span class="o-expandable_cue o-expandable_cue-close">
                    <span class="u-visually-hidden-on-mobile">Hide</span>
                    {% include 'icons/minus-round.svg' %}
                </span>
            </span>
                </button>
                <div class="o-expandable_content {{ '' if is_student else 'o-expandable_content__onload-open' }}">
                    <p>[CAR in position {{ progress.position_idx }}]</p>
                    <p>{{ progress.msg_html|safe }} Extra content...</p>
                    <p>[LISTS]</p>
                </div>
            </div>
            {% set bb = 1 %}
            {% set progress = content.find_bb_progress(bb, subtotals[bb]) %}
            <div class="o-expandable o-expandable__padded">
                <button class="o-expandable_header o-expandable_target"
                        title="Expand content">
                    <h3 class="h4 o-expandable_header-left o-expandable_label">
                        [ICON] {{ bbs[bb].title }}
                    </h3>
                    <span class="o-expandable_header-right o-expandable_link">
                <span class="o-expandable_cue o-expandable_cue-open">
                    <span class="u-visually-hidden-on-mobile">Show</span>
                    {% include 'icons/plus-round.svg' %}
                </span>
                <span class="o-expandable_cue o-expandable_cue-close">
                    <span class="u-visually-hidden-on-mobile">Hide</span>
                    {% include 'icons/minus-round.svg' %}
                </span>
            </span>
                </button>
                <div class="o-expandable_content {{ '' if is_student else 'o-expandable_content__onload-open' }}">
                    <p>[CAR in position {{ progress.position_idx }}]</p>
                    <p>{{ progress.msg_html|safe }} Extra content...</p>
                    <p>[LISTS]</p>
                </div>
            </div>
            {% set bb = 2 %}
            {% set progress = content.find_bb_progress(bb, subtotals[bb]) %}
            <div class="o-expandable o-expandable__padded">
                <button class="o-expandable_header o-expandable_target"
                        title="Expand content">
                    <h3 class="h4 o-expandable_header-left o-expandable_label">
                        [ICON] {{ bbs[bb].title }}
                    </h3>
                    <span class="o-expandable_header-right o-expandable_link">
                <span class="o-expandable_cue o-expandable_cue-open">
                    <span class="u-visually-hidden-on-mobile">Show</span>
                    {% include 'icons/plus-round.svg' %}
                </span>
                <span class="o-expandable_cue o-expandable_cue-close">
                    <span class="u-visually-hidden-on-mobile">Hide</span>
                    {% include 'icons/minus-round.svg' %}
                </span>
            </span>
                </button>
                <div class="o-expandable_content {{ '' if is_student else 'o-expandable_content__onload-open' }}">
                    <p>[CAR in position {{ progress.position_idx }}]</p>
                    <p>{{ progress.msg_html|safe }} Extra content...</p>
                    <p>[LISTS]</p>
                </div>
            </div>
        </div>

        <h2>What does it all mean?</h2>
        <p>Keep in mind that...</p>
        <h4>Want to learn more? Check out these tools:</h4>
        <p>Remember, come back...</p>
        <ul>
            <li>[LIST]</li>
        </ul>

        {% if is_student %}
            <p>
                <a class="results-start-over a-btn a-btn__link a-btn__warning" href="../">
                    Reset survey and start over
                </a>
            </p>
        {% endif %}
    </div>
{% endblock body_content %}

{% block javascript %}
    {{ super() }}

    {# Conditional comment used to block IE8 and under from receiving JS #}
    <!--[if gt IE 8]><!-->
        <script src="{{ static('apps/teachers-digital-platform/js/index.js') }}"></script>
    <!--<![endif]-->
{% endblock javascript %}
