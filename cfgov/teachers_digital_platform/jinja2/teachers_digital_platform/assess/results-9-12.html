{% extends 'content-base.html' %}
{% from 'organisms/expandable.html' import expandable with context %}

{% block title -%}
    Survey Results | Consumer Financial Protection Bureau
{%- endblock %}

{% block css -%}
    {{ super() }}

    <link rel="stylesheet" href="{{ static('apps/teachers-digital-platform/css/main.css') }}">
{%- endblock css %}

{% block pre_content scoped -%}
{%- endblock %}

{% block body_content scoped %}
    <div class="content_wrapper tdp-assessment-results">
        {% set overall = content.find_overall_progress(score) %}
        {% set bbs = content.building_blocks() %}

        {% if not is_student %}
            <article class="m-card">
                <h2 class="m-card_heading">
                    <span>Shared results <span hidden class="show-initials">for <strong></strong></span></span>
                </h2>
                <!-- TODO figure out if something like this will be desired.
                <p>{{ assessment.meta.name }}. Score: {{ "%d" % (score) }}%</p>
                <ul>
                {% for subtotal in subtotals %}
                    {% set progress = content.find_bb_progress(loop.index0, subtotals[loop.index0]) %}
                    <li>{{ bbs[loop.index0].title }}: {{ "%d" % (subtotal) }} pts, level {{ progress.level_idx + 1 }}</li>
                {% endfor %}
                </ul>
                -->
            </article>
        {% endif %}

        <h1>Your money journey results</h1>
        <h2>Congratulations, you've completed the survey! Now let's review your results.</h2>

        <article class="m-card">
            <h2 class="m-card_heading">
                <a href="#">
                    <div class="m-card_icon">
                        {% include 'icons/star.svg' %}
                    </div>
                    <span>Your money journey results</span>
                </a>
            </h2>

            <p>{{ overall.msg_html|safe }}</p>

            <p>[CAR in position {{ overall.position_idx }}]</p>

            <p>[SHARES]</p>
            {% if is_student %}
                <form class="share-url-form">
                    <div class="share-customize">
                        <input class="a-text-input"
                               type="text"
                               name="initials"
                               placeholder="Enter your initials"
                               required minlength="2" maxlength="4" autocomplete="off">
                        <button class="a-btn">Create URL</button>
                    </div>
                    <div class="share-output" hidden>
                        <input readonly type="text" onclick="this.select()" value=""
                               class="shared-url a-text-input a-text-input__full" data-rparam="{{ r_param }}">
                    </div>
                </form>
            {% endif %}

            <h3>Tips to get further down the road on your money journey:</h3>
            <ol>
                <li>[LIST]</li>
            </ol>
        </article>

        <h2>Explore your results</h2>
        <p>The survey questions...</p>
        <p>The three building blocks are:</p>
        <ul>
        {% for subtotal in subtotals %}
            <li><strong>{{ bbs[loop.index0].title }}:</strong> {{ bbs[loop.index0].intro }}</li>
        {% endfor %}
        </ul>

        <h4>Here's how your results break down for each of the building blocks.</h4>

        <div class="o-expandable-group">
            <div class="o-expandable o-expandable__padded">
                <button class="o-expandable_header o-expandable_target"
                        title="Expand content">
                    <h3 class="h4 o-expandable_header-left o-expandable_label">
                        [ICON] Your results for planning and self-control
                    </h3>
                    <span class="o-expandable_header-right o-expandable_link">
                <span class="o-expandable_cue o-expandable_cue-open">
                    <span class="u-visually-hidden-on-mobile">Show</span>
                    {% include 'icons/plus-round.svg' %}
                </span>
                <span class="o-expandable_cue o-expandable_cue-close">
                    <span class="u-visually-hidden-on-mobile">Hide</span>
                    {% include 'icons/minus-round.svg' %}
                </span>
            </span>
                </button>
                <div class="o-expandable_content {{ '' if is_student else 'o-expandable_content__onload-open' }}">
                    {% set bb = 0 %}
                    {% set progress = content.find_bb_progress(bb, subtotals[bb]) %}
                    <p>[CAR in position {{ progress.position_idx }}]</p>
                    <p>{{ progress.msg_html|safe }} Extra content...</p>
                    <p>[LISTS]</p>
                </div>
            </div>
            <div class="o-expandable o-expandable__padded">
                <button class="o-expandable_header o-expandable_target"
                        title="Expand content">
                    <h3 class="h4 o-expandable_header-left o-expandable_label">
                        [ICON] Your results for money habits and values
                    </h3>
                    <span class="o-expandable_header-right o-expandable_link">
                <span class="o-expandable_cue o-expandable_cue-open">
                    <span class="u-visually-hidden-on-mobile">Show</span>
                    {% include 'icons/plus-round.svg' %}
                </span>
                <span class="o-expandable_cue o-expandable_cue-close">
                    <span class="u-visually-hidden-on-mobile">Hide</span>
                    {% include 'icons/minus-round.svg' %}
                </span>
            </span>
                </button>
                <div class="o-expandable_content {{ '' if is_student else 'o-expandable_content__onload-open' }}">
                    {% set bb = 1 %}
                    {% set progress = content.find_bb_progress(bb, subtotals[bb]) %}
                    <p>[CAR in position {{ progress.position_idx }}]</p>
                    <p>{{ progress.msg_html|safe }} Extra content...</p>
                    <p>[LISTS]</p>
                </div>
            </div>
            <div class="o-expandable o-expandable__padded">
                <button class="o-expandable_header o-expandable_target"
                        title="Expand content">
                    <h3 class="h4 o-expandable_header-left o-expandable_label">
                        [ICON] Your results for money knowledge and choices
                    </h3>
                    <span class="o-expandable_header-right o-expandable_link">
                <span class="o-expandable_cue o-expandable_cue-open">
                    <span class="u-visually-hidden-on-mobile">Show</span>
                    {% include 'icons/plus-round.svg' %}
                </span>
                <span class="o-expandable_cue o-expandable_cue-close">
                    <span class="u-visually-hidden-on-mobile">Hide</span>
                    {% include 'icons/minus-round.svg' %}
                </span>
            </span>
                </button>
                <div class="o-expandable_content {{ '' if is_student else 'o-expandable_content__onload-open' }}">
                    {% set bb = 2 %}
                    {% set progress = content.find_bb_progress(bb, subtotals[bb]) %}
                    <p>[CAR in position {{ progress.position_idx }}]</p>
                    <p>{{ progress.msg_html|safe }} Extra content...</p>
                    <p>[LISTS]</p>
                </div>
            </div>
        </div>

        <h2>What does it all mean?</h2>
        <p>Keep in mind that...</p>
        <h4>Want to learn more? Check out these tools:</h4>
        <p>Remember, come back...</p>
        <ul>
            <li>[LIST]</li>
        </ul>

        {% if is_student %}
            <p>
                <a class="a-btn a-btn__warning results-start-over" href="../">
                    Start Over
                </a>
            </p>
        {% endif %}
    </div>
{% endblock body_content %}

{% block javascript %}
    {{ super() }}

    {# Conditional comment used to block IE8 and under from receiving JS #}
    <!--[if gt IE 8]><!-->
        <script src="{{ static('apps/teachers-digital-platform/js/index.js') }}"></script>
    <!--<![endif]-->
{% endblock javascript %}
