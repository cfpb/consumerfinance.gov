{% extends 'layout-full.html' %}

{# HEAD items #}

{% block title -%}
    Prepaid Agreements Search | Consumer Financial Protection Bureau
{%- endblock title %}

{% block css -%}
    {{ super() }}
    <link rel="stylesheet" href="{{ static('apps/prepaid-agreements/css/main.css') }}">
{%- endblock css %}

{# BODY items #}

{% block content_main_modifiers -%}
    content__1-3 prepaid-agreements prepaid-agreements-search
{%- endblock %}

{% block content_main scoped %}
    {%- import 'molecules/breadcrumbs.html' as breadcrumbs with context -%}
    {% set breadcrumb_items = [{
        'href': '/data-research/prepaid-agreements/',
        'title': 'Prepaid account agreements'
    }]%}
    {{ breadcrumbs.render(breadcrumb_items) }}

    <div class="content_wrapper search_form">
        <div class="block block__sub search_intro">
            <h1>Prepaid account agreements database</h1>
            <div class="lead-paragraph u-readable-width">
                Find prepaid product agreements from more than 80 issuers. You can search agreements by issuer name, product name, prepaid account type, and other critera.
            </div>
            <p>Note that we are unable to do a full-text search of agreement files.</p>
            <p>You may also choose to download all prepaid agreements as a <a href="https://files.consumerfinance.gov/a/assets/prepaid-agreements/bulk.zip">single compressed file</a> (1.3 GB, updated nightly).
        </div>

        <div class="search_wrapper block block__sub">
            <form class="u-mt15" method="get" action="." >
                <div id="search-hidden-filters">
                {% for filter in filters %}
                    {% if filter in valid_filters %}
                        {% for val in filters[filter] %}
                            <input type="hidden" name="{{ filter }}" value="{{ val }}">
                        {% endfor %}
                    {% endif %}
                {% endfor %}
                </div>

                <h3 class="h4 u-mb5">Search within</h3>
                <div class="layout-row u-mb30">
                    <div class="a-select flex-fixed">
                        {% set opts = [
                            ('All fields', 'all'),
                            ('Product name', 'name'),
                            ('Program manager', 'program_manager'),
                            ('Other relevant party', 'other_relevant_parties')
                        ]%}
                        <select aria-label="Choose which field will be searched"
                                id="search_field"
                                name="search_field">
                            <optgroup label="Search within">
                                {% for label, val in opts %}
                                <option value="{{ val }}"
                                        {{ 'selected' if search_field == val else '' }}>
                                    {{ label }}
                                </option>
                                {% endfor %}
                            </optgroup>
                        </select>
                    </div>
                    <div class="flex-all">
                        <div class="m-btn-inside-input input-contains-label">
                            <label for="searchText" class="input-contains-label_before input-contains-label_before__search">
                                {{ svg_icon('search') }}
                                <span class="u-visually-hidden">The term to search for</span>
                            </label>
                            <input id="searchText" 
                                   type="text"
                                   autocomplete="off"
                                   class="a-text-input"
                                   name="q"
                                   placeholder="Enter search term"
                                   value="{{ query }}">
                            <a class="a-btn a-btn__link" href="{{ remove_url_parameter(request, { 'q': [query] }) }}">{{ svg_icon('remove') }} Clear</a>
                        </div>
                    </div>
                    <button class="a-btn flex-fixed">Search</button>
                </div>
            </form>
            <p class="block block__sub u-mb15">
                <a href="">View frequently used terms</a>
            </p>
        </div>
    </div>

    <div class="content_wrapper search_results">
        {% include 'search_results.html' %}
    </div>
{% endblock %}
