
/* ==========================================================================
   cfgov-refresh
   nav-primary
   ========================================================================== */

/* topdoc
  name: Primary navigation
  family: cfgov-nav-primary
  patterns:
    - name: nav-primary
      markup: |
        <nav class="primary-nav sliding-nav_nav has-transition">
            <ul class="primary-nav_top-level-list
                       wrapper
                       list__unstyled
                       list__horizontal
                       list-expanding">
                <li class="list_item list-expanding_list-item">
                    <a class="list_link list-expanding_trigger"
                        href="#"
                        role="button"
                        aria-pressed="false"
                        tabindex="0">
                        About
                    </a>
                    <div class="sub-nav_wrapper" aria-expanded="false">
                        <div class="sub-nav_inner-wrapper wrapper">
                            <section class="sub-nav_menu">
                                <h4 class="sub-nav_title">
                                    About Overview
                                </h4>
                                <hr class="content-line content-line__nav">
                                <ul class="sub-nav_menu-list
                                           list__unstyled
                                           list-expanding
                                           list-expanding_child-list">
                                    <li class="list_item list-expanding_list-item">
                                        <a class="list_link list_link" href="/the-bureau/">
                                            The Bureau
                                        </a>
                                    </li>
                                </ul>
                            </section>
                            <aside class="sub-nav_media">
                                <a href="/the-bureau/">
                                    <img src="../../static/img/nav-about-us-video.png"
                                         alt="About Us video image">
                                    <h4 class="short-desc u-mt15">
                                        The CFPB: Working for you.
                                    </h4>
                                </a>
                                <div class="short-desc">
                                    This short video covers what the CFPB is and
                                    how we are working for American consumers.
                                </div>
                            </aside>
                        </div>
                    </div>
                </li>
            </ul>
        </nav>
      notes:
        -
  tags:
    - cfgov-nav-primary
*/

.primary-nav .list_link {
    .u-link__colors(@black, @green);
    .webfont-regular();
}


/* Sliding nav for portrait tablets and smaller
   ========================================================================== */

.respond-to-max(@tablet-max, {

    html,
    body {
        height: 100%;
    }

    .u-show-on-desktop {
        display: none;
    }

    // Remove extra padding added by .wrapper__match-content so the nav button
    // is flush left with the screen.
    .primary-nav_header-space.wrapper__match-content {
        padding-left: 0;
        padding-right: 0;
    }

    .sub-nav_menu-list {
        width: 100%;
    }

    .sub-nav_menu-list .list_link {
        // Override standard visited link color.
        .u-link__colors(@pacific, @pacific, @pacific-50, @pacific, @navy);
    }

    .primary-nav_top-level-list.list-expanding {
        // Nested list borders.
        // Negative bottom margin to remove duplicate bottom border.
        & .list-expanding {
            margin: 0 0 -1px;
        }

        & .list_item {
            display: block;
            border-bottom: 1px solid @gray-50;
            // Overriding .list-horizontal .list_item.
            margin-right: 0;

            &:first-child {
                border-top: 1px solid @gray-50;
            }
        }

        & .list_item__plain {
            border-bottom: 0;
            &:first-child {
                border-top: 0;
            }
        }

        & .list_item a {
            display: block;
            padding: (@grid_gutter-width / 2)
                     @grid_gutter-width
                     (@grid_gutter-width / 2)
                     (@grid_gutter-width / 2);
            position: relative;
            background: @gray-20;
            font-size: unit(18px / @base-font-size-px, em);
        }

        & > .list_item > a:hover {
            background: @white;
            color: @darkgray;
        }

        & > .list_item > a:focus {
            background: @white;
            color: @darkgray;
        }

        & > .list_item > a:active {
            background: @gray-10;
            color: @darkgray;
        }

        & .list_item .list_link__disabled {
            background: @gray-20 !important;
        }

        // Two levels deep.
        & .list-expanding .list-expanding_list-item a {
            padding-left: @grid_gutter-width;
            background: @gray-10;
            font-size: 1em;
        }

        // Three levels deep.
        & .list-expanding .list-expanding .list-expanding_list-item a {
            padding-left: @grid_gutter-width * 1.5;
            background: @gray-5;
        }

        // Give the expanding trigger an icon.
        .list-expanding_trigger:after {
            position: absolute;
            right: @grid_gutter-width / 2;
            font-family: 'CFPB Minicons';
            font-style: normal;
            font-weight: normal;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .list-expanding_trigger[aria-pressed="false"]:after {
            content: "\e006";
        }

        .list-expanding_trigger[aria-pressed="true"]:after {
            content: "\e004";
        }

        // Hide a child list if the trigger is not pressed.
        .list-expanding_trigger[aria-pressed="false"] .list-expanding_child-list {
            display: none;
        }
    }

    .sliding-nav {
        .u-clearfix();
        // Putting the navigation background here instead of on .sliding-nav_nav
        // is a trick to get the bg of the nav to match the height of .sliding-nav_page.
        background: @gray;
    }
    .sliding-nav.is-open {
        overflow: hidden;
    }

    .sliding-nav_page {
        box-sizing: border-box;
        width: 100%;
        float: left;
        background: @white;
        transition: .2s margin-right ease-in, .2s box-shadow ease-in;
    }

    .is-open .sliding-nav_page {
        border-left: 1px solid @gray-80;
        margin-right: -80%;
        position: relative;
        box-shadow: -6px 0 0 rgba(16, 24, 32, 0.2);
    }

    .sliding-nav_page.is-scroll-disabled {
        position: fixed;
        right: 0;
        transition: .2s right ease-in;
    }

    .is-open .sliding-nav_page.is-scroll-disabled {
        position: fixed;
        right: -80%;
        margin-right: 0;
        transition: none;
    }

    .sliding-nav_nav {
        float: left;
        width: 80%;
        height: 101%;
        margin-left: -100%;
        transition: .2s margin-left ease-in;
    }

    .is-open .sliding-nav_nav {
        margin-left: 0;
    }

    .sliding-nav_nav .list-expanding {
        margin: 0;
    }

    .sliding-nav_trigger {
        display: block;
        width: 60px;
        height: 60px;
        padding: 19px 10px 17px;
        border: none;
        border-right: 1px solid @gray-50;
        float: left;
        background: @white;
        color: @gray;
        font-size: 1.5em;

        &:focus {
            outline: 1px dotted @black;
        }
        &:active {
            background: @gray-10;
            color: @black;
        }
    }

});


/* Horizontal mega menu for landscape tablets and larger
   ========================================================================== */

.respond-to-min(@desktop-min, {

    .u-show-on-desktop {
        display: block;
    }

    .content-line__nav {
        border: 1px solid @gray-50;
        border-bottom: none;
        margin-bottom: @grid_gutter-width / 2;
    }

    .sliding-nav {
        position: relative;
    }

    .sliding-nav_trigger {
        display: none;
    }

    .primary-nav {
        position: absolute;
        // Magic number - dependent on height of logo and its vertical padding.
        top: 100px;
        right: 0;
        left: 0;
        z-index: 100;
    }

    .primary-nav_header-space {
        // Magic number - dependent on height of horizontal navbar.
        padding-bottom: 54px;
    }

    .primary-nav_top-level-list {
        padding-left: @grid_gutter-width / 2;
        margin-bottom: 0;
        position: static;
        overflow: visible;
    }

    .primary-nav_top-level-list.list__horizontal > .list_item {
        display: inline-block;
        vertical-align: top;

        &:hover > .list_link,
        &:focus > .list_link {
            padding-bottom: @grid_gutter-width - 6px;
            border-bottom: 6px solid @black;
            color: @black;
        }
    }

    .primary-nav_top-level-list > .list_item > .list_link {
        display: block;
        padding-bottom: @grid_gutter-width;
        // Margin on link for larger hit area.
        margin: 0 0 0 (@grid_gutter-width / 2);
        font-size: unit(18px / @base-font-size-px, em);
    }

    // Hide only when js is available.
    .sub-nav_wrapper {
        position: absolute;
        z-index: 100;
        left: 0;
        overflow: hidden;
        width: 100%;
        max-height: 0;
        background: @gray-5;
        // Maybe this will kick on the gpu?
        transform: translate3d(0,0,0);
    }

    // Expand the menu by looking for aria attributes.
    // This will help us to keep our eye on a11y.
    // The .no-js selector enables simple hover menu support for users w/o JS.
    .sub-nav_wrapper[aria-expanded="true"],
    .no-js .list_item:hover .sub-nav_wrapper {
        border-top: 1px solid @gray-50;
        border-bottom: 4px solid @gray-50;
        z-index: 200;
        max-height: unit(400px / @base-font-size-px, em);
        // Maybe this will kick on the gpu?
        transform: translate3d(0,0,0);
    }

    // Only use transitions when allowed, JS controls transition toggle logic.
    // Transition off.
    .has-transition .sub-nav_wrapper {
        transition: 0.25s max-height linear;
    }

    // Transition on.
    .has-transition .sub-nav_wrapper[aria-expanded="true"] {
        transition: 0.275s max-height ease-out;
    }

    .sub-nav_inner-wrapper {
        padding: @grid_gutter-width 0;
    }

    .sub-nav_menu {
        .grid_column(8);
    }

    .sub-nav_menu-list {
        .grid_column(1, 3);
        vertical-align: top;
        &:first-of-type {
            border-left-width: 0;
        }
    }

    .sub-nav_menu-list .list_link {
       .u-inline-block();
        padding: unit(5px / @font-size-large, em)
                 unit(15px / @font-size-large, em);
        border-left-style: solid;
        border-left-width: 5px;
        font-size: unit(@font-size-large / @base-font-size-px, em);
        .u-link__colors(@pacific, @pacific, @black, @black, @black,
                        transparent, transparent, @green, @green, @green);
        &__current {
            .u-link__colors(@black, @black, @black, @black, @black,
                            @green, @green, @green, @green, @green);
            cursor: default;
        }

        .webfont-regular();
    }

    .sub-nav_menu-list .list_item {
        display: block;
        white-space: nowrap;
        line-height: 2;
    }

    .sub-nav_media {
        position: relative;
        padding: 0 @grid_gutter-width;
        margin-top: 0;
        .grid_column(4);
    }

    .sub-nav_title {
        .webfont-regular();
        font-size: 1em;
        color: @pacific;
    }

});

.respond-to-max(999px, {
    .sub-nav_menu {
        width: 100%;
    }

    .sub-nav_media {
        display: none;
    }
});

.respond-to-range(1000px, @wall-min, {
    .sub-nav_media {
        padding: 0 @grid_gutter-width/2;
    }
});

.respond-to-min(1024px, {
    .primary-nav_top-level-list > .list_item > .list_link {
        // Margin on link for larger hit area.
        margin: 0 (@grid_gutter-width / 2);
    }
});

/* topdoc
    name: EOF
    eof: true
*/
